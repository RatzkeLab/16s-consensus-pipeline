"""
16S Consensus Pipeline - Main Snakefile

This pipeline processes Oxford Nanopore long-read 16S rRNA sequencing data
to generate consensus sequences for each sample.
"""

configfile: "demo/default_config.yaml"

# Include rule modules
include: "rules/common.smk"
include: "rules/check.smk"
include: "rules/filter.smk"
include: "rules/subsample.smk"
include: "rules/align.smk"
include: "rules/consensus.smk"

# ==================== Target Rule ====================

rule all:
    """
    Default target: generate consensus sequences for all passing samples.
    """
    input:
        # Checkpoint outputs
        CHECK_DIR / "read_check_summary.tsv",
        CHECK_DIR / "filtered_check_summary.tsv",
        # Consensus sequences for passing samples
        get_consensus_files
    default_target: True
